# üìñ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é —Å–µ—Ä–≤–∏—Å–æ–≤

–≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –≤ —Å–∏—Å—Ç–µ–º–µ.

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û—Å–Ω–æ–≤—ã](#–æ—Å–Ω–æ–≤—ã)
- [–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞](#—Å–æ–∑–¥–∞–Ω–∏–µ-—Å–µ—Ä–≤–∏—Å–∞)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-—Å–µ—Ä–≤–∏—Å–∞)
- [–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](#–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã](#–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)
- [–ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ](#–º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–µ-–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø—É–±–ª–∏—á–Ω—ã–µ –ø–æ–ª—è](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∏-–∏-–ø—É–±–ª–∏—á–Ω—ã–µ-–ø–æ–ª—è)
- [API Reference](#api-reference)
- [–ü—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∏–º–µ—Ä—ã)

## –û—Å–Ω–æ–≤—ã

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ `BaseService`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª (–∑–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞)
- üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î
- ‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∏ –ø—É–±–ª–∏—á–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
- üåê –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- üîó –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
- üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

## –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞

### –ë–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω

```typescript
// src/services/MyService.ts
import { BaseService, ServiceConfig } from './BaseService';

export default class MyService extends BaseService {
  protected interval = 10_000; // 10 —Å–µ–∫—É–Ω–¥

  constructor() {
    super({
      displayName: '–ú–æ–π —Å–µ—Ä–≤–∏—Å',
      description: '–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–µ—Ä–≤–∏—Å',
      enabled: true,
      autoStart: true,
      tags: ['category', 'feature'],
    });
  }

  protected async onStart(): Promise<void> {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
    await this.logInfo('Service starting');
  }

  protected async tick(): Promise<void> {
    // –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ interval –º—Å
    await this.logInfo('Performing work');
  }
}
```

### –ê–≤—Ç–æ-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

–°–µ—Ä–≤–∏—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü—Ä–æ—Å—Ç–æ –ø–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É `src/services/` –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–ª–∞—Å—Å –∫–∞–∫ `default`.

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞

### ServiceConfig

```typescript
interface ServiceConfig {
  displayName?: string;    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –≤ –∞–¥–º–∏–Ω–∫–µ
  description?: string;    // –û–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
  enabled?: boolean;       // –í–∫–ª—é—á–µ–Ω –ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  interval?: number;       // –ò–Ω—Ç–µ—Ä–≤–∞–ª –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
  autoStart?: boolean;     // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  tags?: string[];        // –¢–µ–≥–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏
}
```

### –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```typescript
constructor() {
  super({
    displayName: '–û—á–∏—Å—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤',
    description: '–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã',
    enabled: true,
    autoStart: false,  // –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ä—É—á–Ω—É—é
    interval: 3600000, // 1 —á–∞—Å
    tags: ['cleanup', 'maintenance', 'storage'],
  });
}
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```typescript
await this.logDebug('–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è', { details: 'data' });
await this.logInfo('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ', { count: 5 });
await this.logWarn('–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ', { reason: 'low memory' });
await this.logError('–û—à–∏–±–∫–∞', { error: error.message });
```

### –ú–∞—Å—Å–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```typescript
await this.logMany([
  {
    level: 'INFO',
    message: 'Batch operation started',
    data: { batchSize: 100 }
  },
  {
    level: 'DEBUG',
    message: 'Processing item',
    data: { itemId: 1 }
  }
]);
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

–õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –ø–æ –∞–¥—Ä–µ—Å—É `/admin/services/{ServiceName}` –≤–æ –≤–∫–ª–∞–¥–∫–µ "–õ–æ–≥–∏" —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é:
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —É—Ä–æ–≤–Ω—é
- –ü–æ–∏—Å–∫–∞ –ø–æ —Ç–µ–∫—Å—Ç—É
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –¥–∞—Ç–µ
- –ü—Ä–æ—Å–º–æ—Ç—Ä–∞ JSON –¥–∞–Ω–Ω—ã—Ö

## –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

```typescript
constructor() {
  super(config);
  this.registerEndpoints();
}

private registerEndpoints(): void {
  // GET —ç–Ω–¥–ø–æ–∏–Ω—Ç
  this.addEndpoint({
    path: '/status',
    method: 'GET',
    handler: () => ({ status: 'running', tasks: this.taskCount }),
    description: '–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞',
    tags: ['status'],
  });

  // POST —ç–Ω–¥–ø–æ–∏–Ω—Ç —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
  this.addEndpoint({
    path: '/tasks',
    method: 'POST',
    handler: async ({ body }: any) => {
      const { name, priority } = body;
      // –õ–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
      return { success: true, taskId: this.createTask(name, priority) };
    },
    schema: {
      body: t.Object({
        name: t.String(),
        priority: t.Optional(t.Union([
          t.Literal('low'), 
          t.Literal('normal'), 
          t.Literal('high')
        ])),
      }),
    },
    description: '–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É',
    tags: ['tasks'],
  });
}
```

### –î–æ—Å—Ç—É–ø –∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º

–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É: `/api/service/{servicename}/{path}`

–ù–∞–ø—Ä–∏–º–µ—Ä: `/api/service/myservice/tasks`

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

–ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –±–∞–∑–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- `GET /api/service/{name}/status` - —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
- `GET /api/service/{name}/settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–∏—Å–∞
- `POST /api/service/{name}/settings` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

## –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

### –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

```typescript
// –í—ã–∑–æ–≤ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
const result = await this.callService('AdvancedExampleService', 'addTask', 'Test Task', 'high');

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
const status = await this.getServiceStatus('ExpiredTransactionWatcher');

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
const services = await this.getAllServices();
```

### –ü—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã

–ß—Ç–æ–±—ã –º–µ—Ç–æ–¥ –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –≤—ã–∑–æ–≤–∞ –∏–∑ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –æ–±—ä—è–≤–∏—Ç–µ –µ–≥–æ –∫–∞–∫ `public`:

```typescript
export default class MyService extends BaseService {
  // –ü—É–±–ª–∏—á–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤
  public async processData(data: any): Promise<any> {
    await this.logInfo('Processing external data', { data });
    // –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
    return result;
  }

  // –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥ - –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ
  private async internalMethod(): Promise<void> {
    // –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ª–æ–≥–∏–∫–∞
  }
}
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø—É–±–ª–∏—á–Ω—ã–µ –ø–æ–ª—è

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```typescript
constructor() {
  super(config);
  
  // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
  this.customSettings = {
    maxRetries: 3,
    timeoutMs: 5000,
    enableFeatureX: true,
  };
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
protected async tick(): Promise<void> {
  const maxRetries = this.getSetting('maxRetries', 3);
  const timeout = this.getSetting('timeoutMs', 5000);
  
  // –õ–æ–≥–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
await this.setSetting('maxRetries', 5);
```

### –ü—É–±–ª–∏—á–Ω—ã–µ –ø–æ–ª—è

```typescript
protected getPublicFields(): Record<string, any> {
  return {
    processedCount: this.processedCount,
    lastProcessTime: this.lastProcessTime,
    isActive: this.isActive,
    customSettings: this.customSettings,
    // –î—Ä—É–≥–∏–µ –ø–æ–ª—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∞–¥–º–∏–Ω–∫–µ
  };
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ –∞–¥–º–∏–Ω–∫–∏
protected async updatePublicFields(fields: Record<string, any>): Promise<void> {
  if (fields.customSettings) {
    for (const [key, value] of Object.entries(fields.customSettings)) {
      await this.setSetting(key, value);
    }
  }
  
  if (fields.isActive !== undefined) {
    this.isActive = fields.isActive;
    await this.logInfo('Activity status changed', { isActive: this.isActive });
  }
  
  await this.updatePublicFieldsInDb(this.getPublicFields());
}
```

## API Reference

### BaseService Methods

#### Lifecycle Methods
- `onStart(): Promise<void>` - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–∞
- `tick(): Promise<void>` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ (abstract)
- `start(): Promise<void>` - –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å
- `stop(): Promise<void>` - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å

#### Logging Methods
- `logDebug(message: string, data?: any): Promise<void>`
- `logInfo(message: string, data?: any): Promise<void>`
- `logWarn(message: string, data?: any): Promise<void>`
- `logError(message: string, data?: any): Promise<void>`
- `logMany(entries: ServiceLogEntry[]): Promise<void>`

#### Settings Methods
- `getSetting<T>(key: string, defaultValue?: T): T`
- `setSetting(key: string, value: any): Promise<void>`

#### Inter-service Methods
- `callService(serviceName: string, method: string, ...args: any[]): Promise<any>`
- `getAllServices(): Promise<string[]>`
- `getServiceStatus(serviceName: string): Promise<any>`

#### Endpoint Methods
- `addEndpoint(endpoint: ServiceEndpoint): void`
- `getEndpoints(): ServiceEndpoint[]`
- `getApp(): Elysia | null`

#### Configuration Methods
- `getPublicFields(): Record<string, any>`
- `updatePublicFields(fields: Record<string, any>): Promise<void>`
- `getServiceConfig(): ServiceConfig`

### Types

```typescript
interface ServiceLogEntry {
  level: LogLevel;
  message: string;
  data?: any;
}

interface ServiceEndpoint {
  path: string;
  method: 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';
  handler: (context: any) => any;
  schema?: any;
  description?: string;
  tags?: string[];
}

type LogLevel = 'DEBUG' | 'INFO' | 'WARN' | 'ERROR';
```

## –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–æ—Å—Ç–æ–π —Å–µ—Ä–≤–∏—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```typescript
import { BaseService } from './BaseService';
import { db } from '../db';

export default class HealthMonitorService extends BaseService {
  protected interval = 60_000; // 1 –º–∏–Ω—É—Ç–∞
  private lastCheckTime = new Date();
  private healthScore = 100;

  constructor() {
    super({
      displayName: '–ú–æ–Ω–∏—Ç–æ—Ä –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã',
      description: '–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö',
      enabled: true,
      autoStart: true,
      tags: ['monitoring', 'health', 'system'],
    });

    this.customSettings = {
      checkDatabase: true,
      checkMemory: true,
      alertThreshold: 80,
    };
  }

  protected async tick(): Promise<void> {
    this.lastCheckTime = new Date();
    let score = 100;

    if (this.getSetting('checkDatabase', true)) {
      score -= await this.checkDatabase();
    }

    if (this.getSetting('checkMemory', true)) {
      score -= await this.checkMemory();
    }

    this.healthScore = Math.max(0, score);

    await this.logInfo('Health check completed', {
      score: this.healthScore,
      timestamp: this.lastCheckTime,
    });

    const threshold = this.getSetting('alertThreshold', 80);
    if (this.healthScore < threshold) {
      await this.logWarn('System health below threshold', {
        score: this.healthScore,
        threshold,
      });
    }
  }

  private async checkDatabase(): Promise<number> {
    try {
      const start = Date.now();
      await db.$queryRaw`SELECT 1`;
      const responseTime = Date.now() - start;

      if (responseTime > 1000) return 20; // –ú–µ–¥–ª–µ–Ω–Ω–∞—è –ë–î
      if (responseTime > 500) return 10;  // –£–º–µ—Ä–µ–Ω–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–∞—è –ë–î
      return 0; // –ë–î –≤ –ø–æ—Ä—è–¥–∫–µ
    } catch (error) {
      await this.logError('Database check failed', { error });
      return 50; // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ë–î
    }
  }

  private async checkMemory(): Promise<number> {
    const memory = process.memoryUsage();
    const usedMB = memory.heapUsed / 1024 / 1024;
    const totalMB = memory.heapTotal / 1024 / 1024;
    const usage = (usedMB / totalMB) * 100;

    if (usage > 90) return 30; // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
    if (usage > 70) return 15; // –í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
    if (usage > 50) return 5;  // –£–º–µ—Ä–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
    return 0; // –ü–∞–º—è—Ç—å –≤ –ø–æ—Ä—è–¥–∫–µ
  }

  protected getPublicFields(): Record<string, any> {
    return {
      healthScore: this.healthScore,
      lastCheckTime: this.lastCheckTime.toISOString(),
      memoryUsage: process.memoryUsage(),
      customSettings: this.customSettings,
    };
  }

  // –ü—É–±–ª–∏—á–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
  public getHealthScore(): number {
    return this.healthScore;
  }
}
```

### –°–µ—Ä–≤–∏—Å —Å API —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏

```typescript
import { BaseService } from './BaseService';
import { t } from 'elysia';

export default class TaskManagerService extends BaseService {
  private tasks: Array<{ id: number; name: string; status: string }> = [];
  private nextId = 1;

  constructor() {
    super({
      displayName: '–ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–¥–∞—á',
      description: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏ —á–µ—Ä–µ–∑ API',
      autoStart: true,
      tags: ['tasks', 'api'],
    });

    this.registerEndpoints();
  }

  private registerEndpoints(): void {
    // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏
    this.addEndpoint({
      path: '/tasks',
      method: 'GET',
      handler: () => ({
        tasks: this.tasks,
        total: this.tasks.length,
      }),
      description: '–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–¥–∞—á',
      tags: ['tasks'],
    });

    // –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
    this.addEndpoint({
      path: '/tasks',
      method: 'POST',
      handler: async ({ body }: any) => {
        const task = {
          id: this.nextId++,
          name: body.name,
          status: 'pending',
        };
        
        this.tasks.push(task);
        await this.logInfo('Task created', { task });
        
        return { success: true, task };
      },
      schema: {
        body: t.Object({
          name: t.String({ minLength: 1 }),
        }),
      },
      description: '–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É',
      tags: ['tasks'],
    });

    // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏
    this.addEndpoint({
      path: '/tasks/:id/status',
      method: 'PATCH',
      handler: async ({ params, body }: any) => {
        const taskId = parseInt(params.id);
        const task = this.tasks.find(t => t.id === taskId);
        
        if (!task) {
          return { success: false, error: 'Task not found' };
        }
        
        task.status = body.status;
        await this.logInfo('Task status updated', { taskId, status: body.status });
        
        return { success: true, task };
      },
      schema: {
        body: t.Object({
          status: t.Union([
            t.Literal('pending'),
            t.Literal('running'),
            t.Literal('completed'),
            t.Literal('failed'),
          ]),
        }),
      },
      description: '–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏',
      tags: ['tasks'],
    });
  }

  protected async tick(): Promise<void> {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ pending –∑–∞–¥–∞—á
    const pendingTasks = this.tasks.filter(t => t.status === 'pending');
    
    for (const task of pendingTasks.slice(0, 3)) { // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø–æ 3 –∑–∞–¥–∞—á–∏ –∑–∞ —Ä–∞–∑
      task.status = 'running';
      
      // –°–∏–º—É–ª—è—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
      setTimeout(() => {
        task.status = Math.random() > 0.1 ? 'completed' : 'failed';
      }, 2000);
    }

    if (pendingTasks.length > 0) {
      await this.logInfo('Processing tasks', { 
        pending: pendingTasks.length,
        processing: Math.min(3, pendingTasks.length),
      });
    }
  }

  protected getPublicFields(): Record<string, any> {
    const statusCounts = this.tasks.reduce((acc, task) => {
      acc[task.status] = (acc[task.status] || 0) + 1;
      return acc;
    }, {} as Record<string, number>);

    return {
      totalTasks: this.tasks.length,
      statusCounts,
      nextId: this.nextId,
    };
  }

  // –ü—É–±–ª–∏—á–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
  public async addTask(name: string): Promise<number> {
    const task = {
      id: this.nextId++,
      name,
      status: 'pending',
    };
    
    this.tasks.push(task);
    await this.logInfo('Task added via service call', { task });
    
    return task.id;
  }
}
```

## üîß –û—Ç–ª–∞–¥–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `/admin/services`
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Å–µ—Ä–≤–∏—Å
3. –í–æ –≤–∫–ª–∞–¥–∫–µ "–õ–æ–≥–∏" –≤—ã –º–æ–∂–µ—Ç–µ:
   - –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —É—Ä–æ–≤–Ω—é (DEBUG, INFO, WARN, ERROR)
   - –ò—Å–∫–∞—Ç—å –ø–æ —Ç–µ–∫—Å—Ç—É
   - –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –¥–∞—Ç–µ
   - –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å JSON –¥–∞–Ω–Ω—ã–µ –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

1. –í–æ –≤–∫–ª–∞–¥–∫–µ "–ü–æ–ª—è" –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –ø—É–±–ª–∏—á–Ω—ã–µ –ø–æ–ª—è —Å–µ—Ä–≤–∏—Å–∞
2. –ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–∏–Ω—Ç–µ—Ä–≤–∞–ª, –≤–∫–ª—é—á–µ–Ω/–≤—ã–∫–ª—é—á–µ–Ω) –≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
3. –ö–Ω–æ–ø–∫–∏ –∑–∞–ø—É—Å–∫–∞/–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Ä–≤–∏—Å–∞

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:

```typescript
protected async tick(): Promise<void> {
  const startTime = Date.now();
  
  try {
    // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞
    
    const processingTime = Date.now() - startTime;
    await this.logDebug('Performance metrics', {
      processingTime,
      memoryUsage: process.memoryUsage(),
    });
  } catch (error) {
    await this.logError('Tick failed', { error, processingTime: Date.now() - startTime });
    throw error;
  }
}
```

## üìù –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–í—Å–µ–≥–¥–∞ –ª–æ–≥–∏—Ä—É–π—Ç–µ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è** —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è** –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
3. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏** –∏ –ª–æ–≥–∏—Ä—É–π—Ç–µ –∏—Ö —Å –¥–µ—Ç–∞–ª—è–º–∏
4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ–ª–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–º–∏** —á–µ—Ä–µ–∑ customSettings
5. **–ü—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ** –¥–ª—è –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
6. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–≥–∏** –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
7. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã** —á–µ—Ä–µ–∑ Swagger UI –≤ `/api/docs`

## üöÄ Deployment

–°–µ—Ä–≤–∏—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –î–ª—è production:

1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `autoStart: false` –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

---

**–ë–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–æ–≤ —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ —Ñ–∞–π–ª–∞—Ö:**
- `ExampleService.ts` - –±–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä
- `AdvancedExampleService.ts` - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø—Ä–∏–º–µ—Ä —Å–æ –≤—Å–µ–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏
- `ExpiredTransactionWatcher.ts` - —Ä–µ–∞–ª—å–Ω—ã–π production —Å–µ—Ä–≤–∏—Å